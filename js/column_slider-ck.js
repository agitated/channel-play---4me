$.widget("bnm.column_slider",{options:{column_class:"li",minColumnWidth:128,speed:2,logdiv:null},total_width:0,content:null,columns:[],touchdown:null,travel:[0,0],maskWidth:function(){return this.element.parent().width()},offset:function(){return this.element.position().left},leftBorder:function(){return-1*this.offset()},rightBorder:function(){return this.leftBorder()+this.maskWidth()},columnLeftEdge:function(e){var t=this.columns[e];return t.left},columnRightEdge:function(e){var t=this.columns[e];return t.left+t.width},offsetToMatchColumnRightEdge:function(e){var t=this.columnRightEdge(e);return this.maskWidth()-t},offsetToMatchColumnLeftEdge:function(e){var t=this.columnLeftEdge(e);return-1*t},stepRight:function(e){var t=0;if(e=="column")var n=this.rightBorder();else var n=this.rightBorder()+this.maskWidth()-this.options.minColumnWidth;while(t<this.columns.length-1&&this.columnRightEdge(t)<n)t++;var r=this.offsetToMatchColumnRightEdge(t);this.slideTo(r)},stepLeft:function(e){var t=this.columns.length-1;if(e=="column")var n=this.leftBorder();else var n=this.leftBorder()-this.maskWidth()+this.options.minColumnWidth;while(t>0&&this.columnLeftEdge(t)>n)t--;var r=this.offsetToMatchColumnLeftEdge(t);this.slideTo(r)},slideTo:function(e){var t=Math.abs(e-this.offset())/this.options.speed;e=Math.min(0,e);e=Math.max(this.leftLimit(),e);this.element.animate({left:e},t)},moveTo:function(e){this.element.css({left:e})},leftLimit:function(){return Math.min(0,this.maskWidth()-this.element.width())},touchEvent:function(e){e.preventDefault();var t=e.originalEvent.touches[0];e.type=="touchstart"&&(this.touchdown={clientX:t.clientX,clientY:t.clientY});if(e.type=="touchmove"){this.travel={clientX:t.clientX-this.touchdown.clientX,clientY:t.clientY-this.touchdown.clientY};this.moveTo(this.offset()+this.travel.clientX);this.touchdown={clientX:t.clientX,clientY:t.clientY}}e.type=="touchend"&&(this.travel.clientX<0?this.stepRight("column"):this.stepLeft("column"));e.type=="touchcancel";e.type=="touchleave";this.log(e.timeStamp+" - "+e.type+" - "+this.element)},log:function(e){this.options.logdiv&&$(this.options.logdiv).prepend($("<div>"+e+"</div>"))},children:function(){return this.element.children(this.options.column_class)},_create:function(){this.initialize()},initialize:function(){if(this.children().size()==0)return;var e=0;this.children().each(function(t,n){e+=$(n).width()});this.element.width(e);this.columns=this.children().map(function(e,t){return{object:t,width:$(t).width(),left:$(t).position().left}});this.element.on("touchstart",$.proxy(this.touchEvent,this));this.element.on("touchmove",$.proxy(this.touchEvent,this));this.element.on("touchend",$.proxy(this.touchEvent,this));this.element.on("touchcancel",$.proxy(this.touchEvent,this));this.element.on("touchleave",$.proxy(this.touchEvent,this))}});